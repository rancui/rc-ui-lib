import{j as s,c as E}from"./locales-548059eb.js";import{r as n}from"./react-libs-840bfe49.js";import{c as L}from"./rc-cli_site-mobile-demo-3935d5c1.js";import{C as U}from"./ConfigProviderContext-0f984393.js";import{a as W}from"./Popup-a2a0dcda.js";import{I as q}from"./index-59db7e48.js";import{a as G}from"./get-rect-4dc7f7e4.js";import{u as H,T as S}from"./index-439e92ef.js";import{u as J}from"./use-touch-76dedc34.js";import{u as K}from"./use-event-listener-721bbec6.js";import{u as Q}from"./use-set-state-898f20ed.js";import{a as k}from"./unit-bb3e6514.js";import{p as V}from"./base-1da74170.js";import{T as Z}from"./index-ec9d0b36.js";import"./mobile-094a819d.js";import"./Overlay-d703c016.js";import"./use-scroll-parent-a4dd715d.js";import"./CSSTransition-ea203202.js";import"./interceptor-35467a90.js";import"./PopupContext-0557b73d.js";import"./use-refs-92151253.js";import"./Sticky-3cb62dae.js";import"./use-update-effect-09c1ca0c.js";import"./scroll-e4e20d56.js";import"./raf-f0838b14.js";import"./index-945c9dff.js";import"./use-gesture-react.esm-484f41f1.js";import"./use-ref-state-6962d29d.js";import"./bound-41eb6e06.js";import"./use-mounted-ref-49b7ba77.js";import"./constant-7552c2aa.js";import"./lock-click-c7a7fb0f.js";import"./Loading-c60598b2.js";import"./render-38a34f7f.js";function z(i,f){return i.reduce((a,c)=>Math.abs(a-f)<Math.abs(c-f)?a:c)}const N=i=>{const{prefixCls:f,createNamespace:a}=n.useContext(U),[c]=a("floating-bubble",f),{offset:l,axis:x,gap:m,magnetic:j,icon:P,onClick:d,teleport:g,children:X}=i,h=H(),u=J(),y=n.useRef(),b=n.useRef(0),T=n.useRef(0),[r,p]=Q({x:0,y:0,width:0,height:0}),[v,C]=n.useState(!1),[Y,B]=n.useState(!0),[w,I]=n.useState(!1),o=n.useMemo(()=>({top:m,right:h.width-r.width-m,bottom:h.height-r.height-m,left:m}),[h,m,r]),$=n.useMemo(()=>{const e={},t=k(r.x),A=k(r.y);return e.transform=`translate3d(${t}, ${A}, 0)`,(v||!w)&&(e.transition="none"),e},[r,v,w]),F=()=>{const{width:e,height:t}=G(y.current);p({x:l.x>1?l.x:h.width-e-m,y:l.y>1?l.y:h.height-t-m,width:e,height:t})},O=e=>{u.start(e),C(!0),b.current=r.x,T.current=r.y};K("touchmove",e=>{if(e.preventDefault(),u.move(e),x!=="lock"&&!u.isTap.current){if(x==="x"||x==="xy"){let t=b.current+u.deltaX.current;t<o.left&&(t=o.left),t>o.right&&(t=o.right),p({x:t})}if(x==="y"||x==="xy"){let t=T.current+u.deltaY.current;t<o.top&&(t=o.top),t>o.bottom&&(t=o.bottom),p({y:t})}}},{target:y.current});const M=()=>{var e;if(C(!1),j==="x"){const t=z([o.left,o.right],r.x);p({x:t})}if(j==="y"){const t=z([o.top,o.bottom],r.y);p({y:t})}if(!u.isTap.current){const t=V(r,["x","y"]);(b.current!==t.x||T.current!==t.y)&&((e=i==null?void 0:i.onOffsetChange)==null||e.call(i,t))}};n.useEffect(()=>(F(),I(!0),()=>{g&&B(!1)}),[]);const R=()=>Y&&s.jsx("div",{className:E(c()),ref:y,onTouchStart:O,onTouchEnd:M,onTouchCancel:M,onClick:e=>{u.isTap.current&&(d==null||d(e))},style:$,children:X||s.jsx(q,{name:P,className:E(c("icon"))})});return g?W(g,R()):R()};N.defaultProps={gap:24,axis:"y",offset:{x:-1,y:-1},teleport:()=>document.body};const D=N;const Xt=()=>{const{DemoBlock:i,DemoSection:f}=L,[a,c]=n.useState(0);return s.jsx(f,{children:s.jsx(i,{children:s.jsxs(S,{active:a,onChange:l=>c(l),children:[s.jsx(S.TabPane,{title:"基础用法",children:a===0&&s.jsx(D,{icon:"chat-o",onClick:()=>Z("点击气泡")})}),s.jsx(S.TabPane,{title:"自由拖拽和磁吸",children:a===1&&s.jsx(D,{icon:"chat-o",axis:"xy",magnetic:"x"})})]})})})};export{Xt as default};
