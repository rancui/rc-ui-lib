import{j as t,c as j}from"./locales-548059eb.js";import{r as o,R as N}from"./react-libs-840bfe49.js";import{c as M}from"./rc-cli_site-mobile-demo-3935d5c1.js";import{C as G}from"./ConfigProviderContext-0f984393.js";import{B as D,c as P}from"./constant-7552c2aa.js";import{u as S}from"./use-update-effect-09c1ca0c.js";import{a as O}from"./unit-bb3e6514.js";import{a as T}from"./index-9cdb6f61.js";import{N as w}from"./NumberKeyboard-4a435183.js";import"./mobile-094a819d.js";import"./base-1da74170.js";import"./index-59db7e48.js";import"./Loading-c60598b2.js";import"./Popup-a2a0dcda.js";import"./Overlay-d703c016.js";import"./use-touch-76dedc34.js";import"./use-scroll-parent-a4dd715d.js";import"./CSSTransition-ea203202.js";import"./use-event-listener-721bbec6.js";import"./interceptor-35467a90.js";import"./PopupContext-0557b73d.js";import"./event-07a78c2b.js";import"./use-click-away-fbf72a4b.js";const U=6,V=o.forwardRef((n,l)=>{const{prefixCls:c,createNamespace:F}=o.useContext(G),[r]=F("password-input",c),v=o.useRef(null),R=o.useRef(null),[u,i]=o.useState(n.value),{length:h,value:x,focused:I}=n,b=n.errorInfo||n.info,f=h>0&&h<1/0?Math.floor(h):U;S(()=>{["",void 0].includes(x)&&i(""),i(x.slice(0,f))},[x,f]),o.useEffect(()=>{var e,a;u.length>=f&&((e=n.onFill)==null||e.call(n,u)),(a=n.onChange)==null||a.call(n,u.slice(0,f))},[n.onChange,n.onFill,u,f]);const C=()=>{var e,a;n.keyboard||(e=R.current)==null||e.focus(),(a=n.onFocus)==null||a.call(n)},k=()=>{var e;(e=n.onBlur)==null||e.call(n)};o.useImperativeHandle(l,()=>({focus:()=>C(),blur:()=>{var e;k(),(e=R.current)==null||e.blur()},resetValue:()=>{i("")}}));const B=()=>{const e=[],{mask:a,gutter:d}=n;for(let m=0;m<h;m++){const s=u[m],y=m!==0&&!d,L=I&&m===u.length;let E;m!==0&&d&&(E={marginLeft:O(d)}),e.push(t.jsxs("li",{className:j({[P]:y},r("item",{focus:L})),style:E,children:[a?t.jsx("i",{style:{visibility:s?"visible":"hidden"}}):s,L&&t.jsx("div",{className:j(r("cursor"))})]},m))}return e};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{ref:v,tabIndex:0,onFocus:C,onBlur:k,className:j(r()),children:[t.jsx("ul",{className:j(r("security"),{[D]:!n.gutter}),children:B()}),b&&t.jsx("div",{className:j(r(n.errorInfo?"error-info":"info")),children:b}),t.jsx("input",{ref:R,className:j(r("native-input")),value:u,type:"text",pattern:"[0-9]*",inputMode:"numeric",onChange:e=>{i(e.target.value.slice(0,n.length))}})]}),n.keyboard&&N.cloneElement(n.keyboard,{visible:I,onInput:e=>{u.length<f&&i((u+e).slice(0,n.length))},onDelete:()=>{i(u.slice(0,-1))},onClose:()=>{var e;(e=v.current)==null||e.blur()},onBlur:()=>{var e;(e=v.current)==null||e.blur()}})]})});V.defaultProps={value:"",info:null,errorInfo:null,length:U,gutter:0,mask:!0,focused:!1,onChange:()=>{}};const g=V;const _={nativeInput:"123",showInfo:"123",addGutter:"123",basicUsage:"123",removeMask:"123",customLength:"123",setValue:"123"},ie=()=>{const{DemoSection:n,DemoBlock:l}=M,[c,F]=o.useState(_),[r,v]=o.useState(null),[R,u]=o.useState(""),i=o.useRef(null),h=o.useRef(null),x=o.useRef(null),I=o.useRef(null),b=o.useRef(null),f=o.useRef(null),C=o.useRef(null),k=o.useRef(null),B={showInfo:f,nativeInput:h,addGutter:I,basicUsage:i,removeMask:b,customLength:x,setValue:C};o.useEffect(()=>{if(r){const s=B[r].current,{top:y}=s.getBoundingClientRect();window.scrollTo(0,window.pageYOffset+y)}},[r]);const e=s=>{v(s)},a=()=>{v("")},d=(s,y)=>{console.log(s,y)},m=()=>{u("密码错误")};return t.jsxs(n,{children:[t.jsx(l,{ref:i,card:!0,title:"基础用法",children:t.jsx(g,{value:c.basicUsage,focused:r==="basicUsage",onFocus:()=>e("basicUsage"),onBlur:a,onChange:s=>d(s,"basicUsage"),keyboard:t.jsx(w,{})})}),t.jsx(l,{ref:h,card:!0,title:"原生键盘用法",children:t.jsx(g,{value:c.nativeInput,focused:r==="nativeInput",onFocus:()=>e("nativeInput"),onBlur:a,onChange:s=>d(s,"nativeInput")})}),t.jsx(l,{ref:x,card:!0,title:"自定义长度",children:t.jsx(g,{value:c.customLength,length:4,focused:r==="customLength",onFocus:()=>e("customLength"),onBlur:a,onChange:s=>d(s,"customLength"),keyboard:t.jsx(w,{})})}),t.jsx(l,{ref:I,card:!0,title:"格子间距",children:t.jsx(g,{value:c.addGutter,gutter:10,focused:r==="addGutter",onFocus:()=>e("addGutter"),onBlur:a,onChange:s=>d(s,"addGutter"),keyboard:t.jsx(w,{})})}),t.jsx(l,{ref:b,card:!0,title:"明文展示",children:t.jsx(g,{value:c.removeMask,mask:!1,focused:r==="removeMask",onBlur:a,onFocus:()=>e("removeMask"),keyboard:t.jsx(w,{})})}),t.jsx(l,{ref:f,card:!0,title:"提示信息",children:t.jsx(g,{value:c.showInfo,info:"密码为 6 位数字",errorInfo:R,onFill:m,focused:r==="showInfo",onFocus:()=>e("showInfo"),onBlur:a,onChange:s=>d(s,"showInfo"),keyboard:t.jsx(w,{})})}),t.jsxs(l,{ref:C,card:!0,title:"手动清空密码",children:[t.jsx(T,{type:"primary",onClick:()=>{var s;(s=k.current)==null||s.resetValue()},style:{margin:"var(--rc-password-input-margin) var(--rc-padding-md)"},children:"清空密码"}),t.jsx(g,{ref:k,value:c.setValue,mask:!1,focused:r==="setValue",onBlur:a,onFocus:()=>e("setValue")})]})]})};export{ie as default};
