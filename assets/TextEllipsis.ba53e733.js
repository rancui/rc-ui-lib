import{r as c,a as I,j as L}from"./react-libs.762d0c40.js";import{c as N}from"./locales.fc745e15.js";import{C as M}from"./ConfigProviderContext.29f96478.js";import{u as R}from"./use-event-listener.d41b1855.js";const H=e=>{const{prefixCls:w,createNamespace:b}=c.exports.useContext(M),[f]=b("text-ellipsis",w),[h,A]=c.exports.useState(!1),[S,y]=c.exports.useState(!1),x=c.exports.useRef(null),[v,g]=c.exports.useState(""),d=o=>{if(!o)return 0;const s=o.match(/^\d*(\.\d*)?/);return s?Number(s[0]):0},p=()=>{const o=()=>{if(!x.current)return;const i=window.getComputedStyle(x.current),t=document.createElement("div");return Array.prototype.slice.apply(i).forEach(a=>{t.style.setProperty(a,i.getPropertyValue(a))}),t.style.position="fixed",t.style.zIndex="-9999",t.style.top="-9999px",t.style.height="auto",t.style.minHeight="auto",t.style.maxHeight="auto",t.innerText=e.content,document.body.appendChild(t),t},s=(i,t)=>{const{content:l,expandText:a}=e,C="...";let m=0,u=l.length,E=-1;for(;m<=u;){const r=Math.floor((m+u)/2);i.innerText=l.slice(0,r)+C+a,i.offsetHeight<=t?(m=r+1,E=r):u=r-1}return l.slice(0,E)+C},n=o();if(!n)return;const{paddingBottom:k,paddingTop:z,lineHeight:B}=n.style,T=(Number(e.rows)+.5)*d(B)+d(z)+d(k);T<n.offsetHeight?(y(!0),g(s(n,T))):(y(!1),g(e.content)),document.body.removeChild(n)},P=o=>{var s;A(n=>!n),(s=e.onClick)==null||s.call(e,o)},j=()=>L("span",{className:N(f("action")),onClick:P,children:h?e.collapseText:e.expandText});return c.exports.useEffect(()=>{p()},[e.content,e.rows]),R("resize",p),I("div",{ref:x,className:N(e.className,f()),children:[h?e.content:v,S?j():null]})};H.defaultProps={rows:1,expandText:"",collapseText:""};const F=H;export{F as T};
